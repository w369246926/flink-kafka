package flink.test;

	import java.io.IOException;
	import java.io.UnsupportedEncodingException;
	import java.net.DatagramPacket;
	import java.net.DatagramSocket;
	import java.net.InetSocketAddress;
	import java.net.SocketException;

	/**
	 * UdpClientUtils
	 * @author zhengkai.blog.csdn.net
	 */
	public class UdpClinet {
	    private static DatagramSocket clientSocket = null;
	    private static InetSocketAddress serverAddress = null;
	    /**编码格式，一般gbk或者utf-8*/
	    private static String CHARSET_NAME="gbk";
	    //private static String UDP_URL="10.10.42.241";
		//private static String UDP_URL="39.96.136.7";
		private static String UDP_URL="127.0.0.1";
	    private static Integer UDP_PORT=20182;

	    public static DatagramSocket getDatagramSocket()throws SocketException {
	        return (clientSocket == null)?new DatagramSocket( ):clientSocket;
	    }
	    public static InetSocketAddress getInetSocketAddress(String host, int port)throws SocketException {
	        return (serverAddress == null)?new InetSocketAddress(host, port):serverAddress;
	    }

	    public static void send(String host, int port,String msg) throws IOException {
	        try {
	            byte[] data = msg.getBytes(CHARSET_NAME);
	            DatagramPacket packet = new DatagramPacket(data, data.length, getInetSocketAddress(host,  port));
	            getDatagramSocket().send(packet);
	            getDatagramSocket().close();
	        } catch (UnsupportedEncodingException e) {
	            e.printStackTrace();
	        }
	    }


	    public static void main(String[] args) throws Exception {
	        //main方法用于测试
	        for (int i = 0; i <5000 ; i++) {
	        	//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":6,\"messageLoadLength\":2696,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":61,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":2123602968,\"messageInputPhysicsPort\":0,\"srcMac\":\"04:F9:38:B8:31:5B\",\"destMac\":\"90:2E:A2:CC:0A:B3\",\"srcIp\":\"10.10.42.55\",\"destIp\":\"10.10.11.132\",\"srcPort\":-2127,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":8000,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":10157927,\"policeIndex\":2,\"verifyFunctionModuleCode\":5,\"verifyTypeId\":1,\"verifyMessageBodyType\":1,\"loadLength\":42}]}");

				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":6,\"messageLoadLength\":2696,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":61,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":2123602968,\"messageInputPhysicsPort\":0,\"srcMac\":\"04:F9:38:B8:31:5B\",\"destMac\":\"90:2E:A2:CC:0A:B3\",\"srcIp\":\"10.10.42.55\",\"destIp\":\"10.10.11.132\",\"srcPort\":-2127,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":8000,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":10157927,\"policeIndex\":2,\"verifyFunctionModuleCode\":5,\"verifyTypeId\":2,\"verifyMessageBodyType\":1,\"loadLength\":42}]}");

				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":6,\"messageLoadLength\":2696,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":61,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":2123602968,\"messageInputPhysicsPort\":0,\"srcMac\":\"04:F9:38:B8:31:5B\",\"destMac\":\"90:2E:A2:CC:0A:B3\",\"srcIp\":\"10.10.42.55\",\"destIp\":\"10.10.11.132\",\"srcPort\":-2127,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":8000,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":10157927,\"policeIndex\":2,\"verifyFunctionModuleCode\":5,\"verifyTypeId\":3,\"verifyMessageBodyType\":1,\"loadLength\":42}]}");

				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":0,\"messageLoadLength\":2744,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":72,\"messageBodyId\":14,\"messageBodyType\":1,\"typeId\":7,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":6755317,\"messageInputPhysicsPort\":0,\"srcMac\":\"54:EE:75:2C:29:5A\",\"destMac\":\"50:2E:A0:CC:0A:B3\",\"srcIp\":\"10.10.42.55\",\"destIp\":\"10.10.41.96\",\"srcPort\":-12219,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":254,\"currentState\":3,\"upByteNumber\":350,\"downByteNumber\":0,\"upPackageNumber\":5,\"downPackageNumber\":0,\"flowIndex\":8489171,\"policeIndex\":0,\"verifyMessageBodyType\":1,\"loadLength\":52,\"verifyTypeId\":7,\"verifyFunctionModuleCode\":5}],\"tempVerifyCode\":34,\"messageSplit\":false}");
				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":0,\"messageLoadLength\":2784,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":72,\"messageBodyId\":12,\"messageBodyType\":1,\"typeId\":8,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":-1813957345,\"messageInputPhysicsPort\":0,\"srcMac\":\"04:F9:38:B8:31:5B\",\"destMac\":\"50:2E:A0:CC:0A:B3\",\"srcIp\":\"10.10.11.236\",\"destIp\":\"10.10.41.96\",\"srcPort\":-9496,\"destPort\":254,\"vlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":254,\"currentState\":2,\"upByteNumber\":546,\"downByteNumber\":0,\"upPackageNumber\":0,\"downPackageNumber\":0,\"flowIndex\":0,\"policeIndex\":0,\"verifyMessageBodyType\":1,\"loadLength\":52,\"verifyTypeId\":8,\"verifyFunctionModuleCode\":5}],\"tempVerifyCode\":-66,\"messageSplit\":false}");
				UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":134,\"messageLoadLength\":2720,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":1356,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":407463482,\"messageInputPhysicsPort\":1,\"srcMac\":\"B0:25:AA:2B:A6:CF\",\"destMac\":\"50:2E:A0:CC:0A:B3\",\"srcIp\":\"10.10.41.108\",\"destIp\":\"10.10.41.96\",\"srcPort\":-11657,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":254,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":7433001,\"policeIndex\":0,\"loadLength\":42,\"verifyMessageBodyType\":1,\"verifyTypeId\":5,\"verifyFunctionModuleCode\":5}],\"tempVerifyCode\":-14,\"messageSplit\":false}");
				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":134,\"messageLoadLength\":2720,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":1356,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":407463482,\"messageInputPhysicsPort\":1,\"srcMac\":\"B0:25:AA:2B:A6:CF\",\"destMac\":\"50:2E:A0:CC:0A:B3\",\"srcIp\":\"10.10.41.108\",\"destIp\":\"10.10.41.96\",\"srcPort\":-11657,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":254,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":7433001,\"policeIndex\":0,\"loadLength\":42,\"verifyMessageBodyType\":1,\"verifyTypeId\":1,\"verifyFunctionModuleCode\":6}],\"tempVerifyCode\":-14,\"messageSplit\":false}");
				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.46\",\"messageDeviceSerialId\":\"JAJX02710001C064\",\"messagePackageId\":134,\"messageLoadLength\":2720,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":1356,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":407463482,\"messageInputPhysicsPort\":1,\"srcMac\":\"B0:25:AA:2B:A6:CF\",\"destMac\":\"50:2E:A0:CC:0A:B3\",\"srcIp\":\"10.10.41.108\",\"destIp\":\"10.10.41.96\",\"srcPort\":-11657,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":254,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":7433001,\"policeIndex\":0,\"loadLength\":42,\"verifyMessageBodyType\":1,\"verifyTypeId\":1,\"verifyFunctionModuleCode\":6}],\"tempVerifyCode\":-14,\"messageSplit\":false}");



				//UdpClinet.send(UdpClinet.UDP_URL,UdpClinet.UDP_PORT,"{\"messageProtocolVersion\":\"V0.0.0.1\",\"messageDeviceTypeId\":50,\"messageProductId\":49,\"messageDeviceDescribe\":\"C064\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\",\"messageEmbeddedSoftwareVersion\":\"V-731.-114-125.342.00\",\"messageChipVersion\":\"V1833.634.11.41\",\"messageDeviceSerialId\":\"JAJX02710001C061\",\"messagePackageId\":6,\"messageLoadLength\":2696,\"messageNumber\":20,\"messageSplitSerialId\":0,\"verifyCode\":0,\"reserved\":0,\"basicMessageBasicList\":[{\"messageBodyLength\":60,\"messageBodyId\":61,\"messageBodyType\":1,\"typeId\":1,\"functionModuleCode\":5,\"sendSourceModuleId\":7,\"timeStamp\":2123602968,\"messageInputPhysicsPort\":0,\"srcMac\":\"04:F9:38:B8:31:5B\",\"destMac\":\"90:2E:A2:CC:0A:B3\",\"srcIp\":\"10.10.42.88\",\"destIp\":\"10.10.11.188\",\"srcPort\":-2127,\"destPort\":254,\"originalPackageVlan\":0,\"protocolType\":6,\"changeIp\":\"192.168.11.234\",\"changePort\":8000,\"currentState\":2,\"byteNumber\":0,\"flowIndex\":10157927,\"policeIndex\":2,\"verifyFunctionModuleCode\":5,\"verifyTypeId\":8,\"verifyMessageBodyType\":1,\"loadLength\":42}]}");
				Thread.sleep(1000);
				System.out.println("已发送");
	        }

	    }

	}

